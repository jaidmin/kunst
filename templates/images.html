{% extends 'base.html' %}



{% block content %}
    <div class="container">

        {% for image in images %}

            {% if forloop.counter0|divisibleby:4 %}
                <div class="row">
            {% endif %}
        <div class="col s2 push-s2">
            <div class="card">
                <div class="card-image">
                    <a href="{% url 'image_detail' image.originalImage.id %}"> <img src="{{ image.thumbnail.url }}"></a>
                </div>
                <div class="card-content">
                    <p>{{ image.userDescription }}</p>
                </div>
            </div>
        </div>
        {% if  forloop.counter0|add:1|divisibleby:4 %}
            </div>
        {% endif %}

        {% endfor %}
    </div>
     <!-- the closing div is necessesary even though it seemingly doesnt close anythin-->
</div>


    <script type="text/javascript">


        function checkIfChanged(currentCount) {
            renderCount = {{ renderCount }};

            console.log("renderCount: ", renderCount);
            console.log("currentCount:", currentCount);
            if (currentCount != renderCount) {
                location.reload(true);
            }

        }

        setInterval(function (renderCount) {
            $.getJSON(url = "{% if scope == "private" %}{% url "currentcount_private" %} {% else %} {% url "currentcount_public" %} {% endif %}", function (data) {
                checkIfChanged(data.currentCount);
            });
        }, 5000);

    </script>
{% endblock %}
